# Returns a color sampled from a smooth, perceputally uniform rainbow ranging
# from 0.0 to 1.0
#
# Uses a 5th-order polynomial approximation of Turbo
# https://blog.research.google/2019/08/turbo-improved-rainbow-colormap-for.html
# modified from https://observablehq.com/@mbostock/turbo
function get_rainbow_color(x)
    x = max(0, min(1, x));
    return (
      (34.61 + x * (1172.33 - x * (10793.56 - x * (33300.12 - x * (38394.49 - x * 14825.05))))) / 255.0,
      (23.31 + x * (557.33 + x * (1225.33 - x * (3574.96 - x * (1073.77 + x * 707.56))))) / 255.0,
      (27.2 + x * (3211.1 - x * (15327.97 - x * (27814 - x * (22569.18 - x * 6838.66))))) / 255.0,
    )
end

# Returns a discrete color for each `n` from 1 to 22 (after that it repeats)
#
# Stolen shamelessly from https://sashamaps.net/docs/resources/20-colors/
function get_discrete_color(n)
    local colormap = [
        (0.9019607843137255, 0.09803921568627451, 0.29411764705882354),
        (0.23529411764705882, 0.7058823529411765, 0.29411764705882354),
        (1.0, 0.8823529411764706, 0.09803921568627451),
        (0.2627450980392157, 0.38823529411764707, 0.8470588235294118),
        (0.9607843137254902, 0.5098039215686274, 0.19215686274509805),
        (0.5686274509803921, 0.11764705882352941, 0.7058823529411765),
        (0.27450980392156865, 0.9411764705882353, 0.9411764705882353),
        (0.9411764705882353, 0.19607843137254902, 0.9019607843137255),
        (0.7372549019607844, 0.9647058823529412, 0.047058823529411764),
        (0.9803921568627451, 0.7450980392156863, 0.7450980392156863),
        (0.0, 0.5019607843137255, 0.5019607843137255),
        (0.9019607843137255, 0.7450980392156863, 1.0),
        (0.6039215686274509, 0.38823529411764707, 0.1411764705882353),
        (1.0, 0.9803921568627451, 0.7843137254901961),
        (0.5019607843137255, 0.0, 0.0),
        (0.6666666666666666, 1.0, 0.7647058823529411),
        (0.5019607843137255, 0.5019607843137255, 0.0),
        (1.0, 0.8470588235294118, 0.6941176470588235),
        (0.0, 0.0, 0.4588235294117647),
        (0.5019607843137255, 0.5019607843137255, 0.5019607843137255),
        (1.0, 1.0, 1.0),
        (0.0, 0.0, 0.0),
    ]
    return colormap[(n-1) % 22 + 1]
end
